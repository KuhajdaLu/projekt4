\documentclass[11pt]{article}
\usepackage{graphicx}
\usepackage[czech]{babel}
\usepackage[utf8]{inputenc}
\usepackage{titling}
\usepackage{pdfpages}
\usepackage[nopar]{lipsum}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{caption}
\usepackage{float}
\usepackage{enumitem}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\setlength{\parindent}{1cm}
\setlength{\hoffset}{-1.1cm} 
\setlength{\voffset}{-2cm}
\setlength{\textheight}{23.0cm} 
\setlength{\textwidth}{15cm}

\begin{document}
\title{Bakalářská práce}
\author{Lukáš Kuhajda}
\date{Akademický rok 2018/2019}
\begin{titlepage}
	\begin{center}
		\includegraphics[scale=0.5]{logo_zcu}\\
		\vspace{5cm}
		\begin{Large}
			\textbf{\thetitle}\\
		\end{Large}
		
		\vspace{3cm}
		\theauthor\\
		\vspace{5cm}
		\thedate
	\end{center}
\end{titlepage}
\newpage	
	
\tableofcontents
\newpage



\section{SLAM - Simultaneous Localization and Mapping}

\subsection{Úvod}
Simultaneous localization and mapping, v překladu simultánní lokalizace a mapování (SLAM) je problém, při kterém řešíme otázku, zda-li dokáže robot, umístěný do neznámého prostředí a s neznámou lokací, postupně utvářet mapu svého okolí a zároveň určovat místo, ve kterém se nachází. Řešení tohoto problému je nezbytně nutné pro tvorbu zcela autonomně se pohybujících robotů. Jedná se o aktuální téma vhledem k trendům moderní doby, kdy dochází k pozvolnému přechodu na samořiditelná auta. \\


\subsection{Historie}
Jako počátek, kdy byl daný problém poprvé zíněn, se bere konference Robotics and Automation Conference konaná v roce 1986. Pravděpodobnostní metody byly tehdy ještě velmi nerozvinuté, jak v robotice, tak i v umělé inteligenci, a došlo tak pouze k debatě na dané téma.\\
\indent K většímu posunu kupředu se dostalo o pár let později, kdy vyšla práce pojednávající o vztahu mezi orientačními body (landmarky) a zmenšení geometrické nepřesnosti. Důležitým prvkem zde bylo zjištění, že mezi odhady landmarků na mapě musí být velký stupeň korelace, přičemž korelace roste s dalšími pozorováními.\\
\indent Ve stejném období vznikaly základy vizuální navigace a navigace pracující se sonarem s použitím Kalmanova filtru. Práce byly v základu dosti podobné, ukazovaly, že odhady landmarků získané pohybem robota prostředím, jsou v korelaci s ostatními kvůli chybě v odhadu pozice robota a je třeba mít stav složený z pozice robota a landmarků. Vznikal tak však velký stavový vektor s náročností rostoucí v kvadrátu a tendence korelaci landmarků snižovat.\\
\indent Později došlo ke sjednocení problémů lokalizace a mapování a závěru, že snaha minimalizovat korelaci mezi landmarky byla chybná, naopak bylo v zájmu korelaci co nejvíce zvýšit. Struktura SLAMu, a celkově první použití tohoto akronymu, byla prezentována v roce 1995 na International Symposium of Robotics Research (ISRR). Poté v roce 199 se na ISRR odehrálo první zasedání pojednávající přímo o SLAM a došlo k představení práce dosahující stupeň konvergence mezi SLAMem na Kalmanově filtru a pravděpodobnostními metodami pro lokalizaci a mapování.


\subsection{Formulace a struktura SLAM} 
Jedná se o proces, při kterém robot vytváří mapu prostředí, v němž se pohybuje a na základě mapy určuje svoji pozici v prostoru. Pro určování trajektorie robota a rozložení landmarků není třeba znalosti jeho lokace, neboť odhad těchto parametrů probíhá součastně. 

\subsubsection{Legenda}
$k$ ... čas\\
$x_k$ ... stavovoý vektor popisující lokaci a orientaci robota\\ 
$u_k$ ... vektor aplikovaný v čase $k-1$ pro dostání robota v čase $k$ na pozici $x_k$\\
$m_i$ ... vektor popisující pozici i-tého landmarku, která je brána jako neměnící se v čase\\
$z_{ik}$ ... pozorování lokace i-tého landmarku z robota v čase $k$\\
$x_{0:k}$ ... historie umístění robota\\
$u_{0:k}$ ... historie vstupních dat pro pohyb robota\\
$z_{0:k}$ ... množina pozorování landmarků\\
$m$ ... množina landmarků\\

\subsubsection{Pravděpodobnostní SLAM}
V této formě je zapotřebí výpočet rozložení pravděpodobnosti 
$$P(x_k,m|Z_{0:k},U_{0:k},x_0)$$ 
pro každý časový okamžik ${k}$. Jedná se o srduženou posteriorní hustotu landmarků, stavu vozidla s ohledem na zaznamenané pozorování, řídící vstupy a zahrnuje čas ${k}$ s počátečním stavem vozidla. Pro výpočet je využit Bayesův teorém, je tedy potřeba, aby přechodový stavový model a model pozorování popisovaly vliv vstupního řízení a pozorování.\\
\indent Model pozorování popisuje pravděpodobnost zisku pozorování $z_k$, pokud známe polohu vozidla a landmarků. 
$$P(z_k|x_k,m)$$
\indent Model pohybu vozidla může být popsán jako stavový přechodový model. Předpokládáme přechodový stav jako Markovův proces, při kterém následující stav $x_k$ je závislý pouze na předchozím stavu $x_{k-1}$ a aplikovaném řízení $u_k$ a není tak závislý ani na mapě, ani na pozorování.
$$P(x_k|x_{k-1},u_k)$$
Máme tak implementaci ve dvoustupňové rekurzivní formě korekce předpovědí.\\
Aktualizace času:
$$P(x_k,m|Z_{0:k-1},U_{0:k},x_0)=\int P(x_k|x_{k-1},u_k)\times P(x_{k-1},m|Z_{0:k-1},U_{0:k-1},x_0)dx_{k-1}$$ 
Aktualizace měření:
$$P(x_k,m|Z_{0:k},U_{0:k},x_0)=\frac{P(z_k|x_k,m)P(x_k,m|Z_{0:k-1},U_{0:k},x_0)}{P(z_k|Z_{0:k-1},U_{0:k})}$$

\subsubsection{Struktura pravděpodobnostního SLAMu}
Model pozorování udává závislost polohy vozidla a pozování landmarků, sdružená posteriorní pravděpodobnost nemůže být klasicky rozdělena stylem 
$$P(x_k,m|z_k)\neq P(x_k|z_k)P(m|z_k),$$
neboť by to vedlo k chybným odhadům. Dalším zdrojem chyb je špatný odhad pozice robota, landmarky jsou ale silně korelované, takže chybný odhad landmarku vůči mapě nevede k chybné poloze dvou landmarků navzájem.\\
\indent Velmi důležitým poznatkem bylo zjištění, že korelace mezi landmarky monotónně vzrůstá s počtem jejich pozorování (potvrzeno pouze pro lineární Gaussovský případ), tudíž odhad pozice landmarků bude s narůstajícím počtem pozorování monotónně přesnější. Tento jev nastává díky, v podstatě, skoro nezávislému měření relativních pozic mezi landmarky, které jsou zcela nezávislé na natočení vozidla a úspěšné pozorovnání z tohoto bodu může nést další nezávislá měření relativních rozložení landmarků. \\
\indent Pohybem robota v prostoru získává pozorováním novou pozici známých landmarků vůči sobě a dle této informace aktualizuje svoji odhadovanou pozici a také pozici landmarků. Pokud ji nějaký landmark není pozorován, tak je jeho pozice aktualizována dle změny landmarků pozorovaných a pokud jsou zpozorovány landmarky nové, korelují se s zostatními, čímž se vytváří síť. Čím častěji jsou dva landmarky pozorovány při jednom měření, tím je síla korelace větší. Opětovným projížděním mapy tak získáváme přesnější a robustnější mapu.\\


\subsection{Řešení problému SLAM}
Při řešení je potřeba adekvátně obsáhnout jak složku modelace prostředí, tak i tvorbu pohybového modelu.
Máme řadu možností jak tento problém řešit, například princip Monte Carlo, kdy rozdělujeme hustoty pravděpodobnosti odhadu pozice robota. Další možností je Markovova lokalizace, s tímto přístupem jsme se setkali v pravděpodobnostní formě SLAM. Nejčastěji se setkáváme s reprezentací problému ve formě stavového modelu zatíženého šumem, což vede k použití rozšířeného Kalmanova filtru (v originále $extended$ $Kalman$ $filter\rightarrow EKF$). Jinou možností je ještě rozčlenit pohybový model vozidla na vzorky s obecnějším negausovským rozdělením pravděpodobnosti, v tomto případě mluvíme o použití Rao-Blackwellizedova partikulárního filtru. 

\subsubsection{EKF-SLAM}
Popis pohybu vozidla:
$$P(x_k|x_{k-1},u_k)\leftrightarrow x_k=f(x_{k-1},u_k)+w_k$$
$f(.)$ ... funkce modelující pohyb vozidla\\
$w_k$ ... chyby měření\\
$Q_k$ ... kovariance\\
\\
Model pozorování:
$$P(z_k|x_k,m)\leftrightarrow z_k=h(x_k,m)+v_k $$
$h(.)$ ... geometrické vlastnosti\\
$v_k$ ... chyby měření\\
$R_k$ ... kovariance\\
\\
Tyto dvě definice využijeme v EKF metodě k výpočtu průměru a kovariance sdruženého posteriorního rozložení\\
\indent průměr:
$$\begin{bmatrix}
\hat{x}_{k|k}\\\hat{m}_k
\end{bmatrix}=E
\begin{bmatrix}
x_k |Z_{0:k}\\m\indent
\end{bmatrix}$$ 
\indent kovariance:
$$P_{k|k}=\begin{bmatrix}
P_{xx} P_{xm}\\P^T_{xm} P_{mm}
\end{bmatrix}_{k|k}=E\begin{bmatrix}
\begin{pmatrix}
x_k-\hat{x}_k\\m-\hat{m}_k
\end{pmatrix} \begin{pmatrix}
x_k-\hat{x}_k\\m-\hat{m}_k
\end{pmatrix}^T |Z_{0:k}
\end{bmatrix}$$\\
Mezi hlavní problémy této metody se řadí konvergence, výpočetní složitost, sdružování dat a nelinerita. Prvním z nich, konvergence, se projevuje postupným přechodem determinantu kovarianční matice mapy a všech podkategorií dvojic landmarků k nule. Jednotlivé odchylky landmarků pak konvergují dle původních nepřesností z odhadu pozice robota a jeho pozorování.\\
\indent Výpočetní složitost je zde brána jako kvadraticky rostoucí s počtem zaznamenaných landmarků, neboť při každém zaznamenaném pozorování se aktualizují již uložené landmarky, tento problém již ale prošel vývojem a existují metody pracující v reálném čase s tisíci landmarky.\\
\indent Metoda EKF-SLAM je velmi náchylná na chybné spojení pozorování se známými landmarky. Jedná se zejména o problém s uzavřením smyčky, kdy dochází k opětovnému návratu na místo, ze kterého robot začínal nebo ve kterém se již nacházel.\\
\indent Nelinerita je posledním z významných problémů, kvůli níž můžeme dojít k větším nepřesnostem ve výsledku, neboť EKF-SLAM využívá lineárních modelů pro vyjádření nelineárního pohybu a modelu pozorování, konvergence a konzistence modelu je tedy jistá pouze v lineárním případě. 


\subsection{Rao-Blackweillizedův filtr}
Forma SLAM založená na Rao-Blackellizedově filtru, jinak nazývaná také jako FastSLAM, je na bázi rekurzivního Monte Carlo modelu a dokáže reprezentovat nelineání stavový model. Je výpočetně nemožné aplikovat na stavový prostor s vysokým počtem dimenzí partikulární filtry, je však možné redukovat velikost vzorků. \\
Sdružený stav může být jako faktor komponentů vozidla a podmíněných komponentů mapy:
$$P(X_{0:k},m|Z_{0:k},U_{0:k},x_0)=P(m|X_{0:k},Z_{0:k})P(X_{0:k}|Z_{0:k},U_{0:k},x_0) $$ 
Rozdělení pravděpodobnosti zde není na jednotivých pozicích $x_k$, ale na celou trajektorii $X_{0:k}$ a tím se stávají jednotlivé landmarky na sobě nezávislými, mapa je tedy reprezentována jako soubor nezávislých gaussiánů, což znamená lineární složitost oproti kvadratické u formy EKF. Hlavními ukazateli FastSLAMu je mapa, jež je počítána analyticky a vážené vzorky, jimiž je reprezentována trajektorie pohybu. Rekurzivní odhad je proveden partikulárním filtrem pro stav pozice a EKF pro stav mapy.\\
\indent Zpracování každého landmarku probíhá zvlášť, pozice se aktualizuje stejným způsobem jako v EKF a landmarky, které nebyly zpozorovány, zůstávají na původní pozici a neaktualizují se. Vzájemnou neprovázaností landmarků však vzniká chyba v odhadu, která s časem roste.\\
\indent V čase $k-1$, je sdružený stav reprezentovaný jako 
$$\{w^{(i)}_{k-1},X^{(i)}_{0:k-1},P(m|X^{(i)}_{0:k-1},Z_{0:k-1})\}^V_i$$
V prvním kroce, pro každou částici vypočítáme návrh distribuce, jež je podmíněná svojí specifickou historií a z ní odebereme vzorek $x_k$, který je poté sdružen k historii částice $X^{(i)}_{0:k}$. Krokem dva, dle funkce důležitosti, stanovíme váhy vzorků. Třetím krokem je případné převzorkování, které se provádí různě často dle implementace. Krokem posledním je provézt EKF update, na každou, již zpozorovanou částici, která je při aktuálním pozorováním zaznamenána. 


\subsection{Výpočetní složitost}
Neobvyklá struktura problému, sdružený stav složený z pozice robota a landmarků, je využita v řadě metod pro redukci výpočetní složitosti, zde má model procesu vliv pouze na stav pozice robota a model pozorování na dvojici robot-landmark. Základním rozdělením metod redukujících výpočetní složitost, je rozlišování optimálních, konzervativních a nekonzistentních metod. První typ, optimální metody, jsou založené na redukci daného výpočtu, výsledkem jsou pak odhady a kovariance, stejně tak, jako je tomu v případě plnohodnotné formy SLAM, rozebírané v předchozích kapitolách. U metod konzervativních dochází k odhadům s vyšší neurčitostí nebo kovariancí, většinou ale, i přes větší nepřesnost, jsou implementovány v reálném použití. Poslední možností jsou nekonzistentní metody a jedná se o algorithmy, které mají nižsí neurčitost nebo kovarianci, než algoritmy optimální, ale pro řešení SLAM se v praxi nepoužívají.\\
\indent Prvním přístupem pro redukci výpočetní složitosti, je omezení požadovaného výpočtu rovnicí aktualizace pozorování. Výpočet časové aktualizace může být omezen metodami využívající rozšířený stav, výpočet stavu pozorování pak metodami oddělujícími rovnice dané aktualizace a obě tyto omezení vedou k redukci výpočtů, typicky jsou to optimální algoritmy. Další možností, je reformulace stavového prostoru do informační podoby, která umožnuje rozdělení výsledné matice s informacemi pro snížení výpočtů, což bývají algoritmy konzervativní. Obvykle je díky nim znatelně redukována výpočetní složitost a stále je zachována dostatečně dobrá odhadovací schopnost. Dalším přístupem je submapping, který rozděluje mapu na regiony, kdy následné aktualizace se konají pouze v dané oblasti a s určitou periodou poté i v rámci celé mapy. 

\subsubsection{Rozšířený stav}
Sdružený stavový vektor $x_k$ v čase $k$, se skládá z pozice robota a jím zaznamenaných landmarků, kdy model robota ovlivňuje pouze stav pozice, a to vlivem vstupního řízení, stav mapy se tím tedy nemění. 
$$x_k=\begin{bmatrix}
f_v(x_{vk-1},u_k)\\m
\end{bmatrix} $$
Pokud při volbě typu SLAM jako EKF, výpočet předpovědi kovariance má kubicky rostoucí složitost s počtem landmarků
$$P_{k|k-1}=\bigtriangledown f_xP_{k-1|k-1}\bigtriangledown f^T_x+\bigtriangledown f_uU_k\bigtriangledown f^T_u,$$
to se však dá předělat na formu s pouze lineární složitostí
$$P_{k|k-1}=\begin{bmatrix}
\bigtriangledown f_{vx}P_{vv}\bigtriangledown f^T_{vx}+\bigtriangledown f_{vu}U_k\bigtriangledown f^T_{vu}&&\bigtriangledown f_{vx}P_{vm}\\
P^T_{vm}\bigtriangledown f^T_{vx}&&P_{mm}
\end{bmatrix} $$
Přidání nového landmarku má podobný tvar, kdy je nový landmark inicializován jako funkce pozice robota a pozorování a rozšířený stav pak získáme z malého množství existujících stavů 
$$x^+_k=\begin{bmatrix}
x_{vk}\\m\\g(x_{vk},z_k)
\end{bmatrix},$$
kde $g(x_{vk},z_k)=m_{new}\rightarrow$ přidání nového landmarku \\
Rozšíření stavu můžeme aplikovat vždy, když je nový stav funkcí podmnožiny již existujících stavů
$$\begin{bmatrix}
x_1\\x_2\\f(x_2,q)
\end{bmatrix}, $$
$$
\begin{bmatrix}
P_{11}&&P_{13}&&P_{13}\bigtriangledown f^T_{x_2}\\
P^T_{12}&&P_{23}&&P_{23}\bigtriangledown f^T_{x_2}\\
\bigtriangledown f_{x_2}P^T_{11}&&\bigtriangledown f_{x_2}P_{32}&&\bigtriangledown f_{x_2}P_{32}\bigtriangledown f^T_{x_2}+\bigtriangledown f_qQ\bigtriangledown f^T_q
\end{bmatrix}
$$

\subsubsection{Oddělné aktualizace}
Jedná se o metody vytvářející optimální odhady. Při implementaci základní podoby aktualizace pozorování, se při každém novém měření aktualizuje jak stav vozidla, tak i mapy, což vede ke kvadratickému nárůstu složitosti s množstvím landmarků. V této metodě si však rozdělíme mapu na menší oblasti, které se aktualizují pouze při jejím průjezdu, zatímco aktualizace celé mapy probíhá s výrazně nižší frekvencí.\\
\indent Rozlišujeme dva způsoby možné implementace. První z nich pracuje na zmenšené oblasti, ale stále si drží globální referenční souřadnice, jedná se například o algoritmus CEKF (compressed EKF). Druhou možností je tvorba menších map s vlastním souřadnicovým rámcem neopouštějícím danou submapu, což jsou algorithmy CLSF (constrained local submap filter $\rightarrow$ omezený lokální submapový filtr). Pokračovat budeme v rozboru druhé možnosti, neboť je jednodušší a při provádění operací s velkou frekvencí opakování je méně ovlivněna linearizačními chybami, je stabilnější a zabraňuje příliš velkému nárůstu globální kovariance. \\
\indent Logaritmus submapy se skládá z dvou nezávislých odhadů, které si stále udržuje. Jde o vektory $x_G$ a $x_R$, kdy $x_G$ je mapa složená z globálně referencovaných landmarků a globálně referencované pozice dané submapy a $x_R$ je lokální submapa s lokálně referencovanou pozicí robota a lokálně referencovanými landmarky. Při získání pozorování se aktualizují pouze landmarky náležící aktuální submapě, ve které se robot nachází. Celkový globální odhad pak získáváme periodicky, zaevidováním submapy do mapy celé a použitím aktualizace omezení na společné vlatnosti obou map.

\subsubsection{Rozčlenění stavového prostoru}
V této metodě vyjadřujeme stavový odhad ($\hat{x}_k$) a matici kovariance ($P_k$) v informační formě pomocí matice informací $Y_k=P^{-1}_k$ a vektoru informací $\hat{y}_k=Y_k\hat{x}_k$. Je výhodné pro mapy s větším měřítkem, kdy spousta nediagonálních prvků bude velmi blízkých nule, což vede k možnosti nastavení těchto prvků na hodnotu nula. Může tím však vznikat malá ztráta optimality při vzniku map.\\
\indent Rozšíření stavu je rozčleňovací operace vedoucí k přesnému rozčlenění informační formy a má tak ekvivalentní informační formu. Předpokládáme, že podmnožina stavů $x_i$ obsahuje většinu stavů mapy a po rozčlenění dosahuje pouze konstantní složitosti v čase. Můžeme tedy získávat přesné řešení díky rozšiřování stavu novým odhadem pozice robota v každém kroce a zachovat všechny předchozí pozice. Nenulové nediagonální prvky jsou tak pouze ty, které jsou spojené napřímo s měřenými daty.\\
\indent Dále sem musíme zahrnout marginalizaci, jež je nezbytná pro odstranění předchozích stavů pozice. Máme možnost marginalizovat všechny předchozí stavy, což vede na zhuštěnou matici informací, a tedy stav, kterého dosáhnout nechceme. Správnou volbou ukotvení pozice můžeme marginalizovat velkou čast pozic, aniž bychom vyvolaly nadměrnou hustotu matice informací.

\subsubsection{Globální submapy}
Rozlišujeme dva základní typy submap a to globálně a lokálně referencované, přičemž oba mají společné, že submapa stanovuje místní souřadnicový rámec a landmarky z jejího okolí jsou odhadovány s ohledem na tento rámec.\\
\indent Lokální metoda získává odhady pomocí optimálního algoritmu, používajícího pouze lokální landmarky. Tato metoda, i přes výpočetní efektivitu, je při tvorbě struktury submap neoptimální. Globální metoda dokáže z kvadraticky rostoucí složitosti, udělat lineární, či dokonce v čase konstantní složitost. Je to možné díky údržbě a konzervativním odhadům celé mapy. Metoda stojí na odhadování globální pozice submapy v rámci mapy, nevede však ke zmírnění problémů s linearizací, způsobenou velkými nepřesnostmi v odhadu pozic.

\subsubsection{Submapy vztažné}
Základním rozdílem od metody globálních submap, je absence společného základního rámce. V této metodě se submapy zaznamenávají dle sousedství s ostatními a celou mapu pak můžeme získat souhrnem vektoru cesty. Submapy jsou, díky vyhýbání se globálním spojením, velmi zajímavé z hlediska výpočetní složitosti a problémům týkajících se nelinearity. Velkým kladem je například tvorba lokálně optimální mapy s výpočetní složitostí nezávislou na celkové velikosti mapy a dále, díky úpravám pouze na lokální úrovni, je velmi stabilní.


\subsection{Asociace dat}
Jedná se velmi důležitý problém, neboť, i když během procesu tvorby mapy dojde pouze k jedné chybné asociaci dat, může to vézt k destabilizaci odhadu mapy, často dokonce k pádu celého algoritmu

\subsubsection{Validace várky dat}
Z prvu se k problému přistupovalo způsobem, kdy se každé jednotlivé zachycení landmarku porovnávalo se všemi odhady nacházejícími se v blízkém okolí. Tento individuální přístup je neproveditelný, pokud je nejistá pozice robota, cožje tedy neproveditelné obzvlášť v málo zaplněných prostředích. 

\subsubsection{Popis vzhledu}
Jedním ze způsobů snímání okolí je vidění, kdy zaznamenáváme tvar, barvu, strukturu, a tím dokážeme rozlišovat různé balíčky dat, což využíváme pro přepověd dané asociace, nejčastěji pro problém s uzavřením smyčky. Pokrok této metody přišel, když se začala počítat metrika podobnosti přes sekvenci obrazů, místo původního jednoho. 

\subsubsection{Multihypoziční asociace dat}
Jedná se o metodu nepostradatelnou pro robustní sběr dat v přeplněním prostředí, kdy vytváříme oddělené odhady trasy jízdy pro každou asociační hypotézu. Tato funkce je však silně limitována dotupným výpočetním výkonem. Dále je metoda vyžívána při implementaci robustního SLAMu ve velkých prostředích, kdy je při uzavírání smyčky vytvořena hypotéza pro smyčku uzavřenou i pro stále neuzavřenou, a tím se bere v potaz, že je prostředí pouze podobné. 


\subsection{Reprezentace prostředí}
Původně se svět modeloval jen jako soubor landmarků majících svůj určitý tvar, později však, zejména ve venkovním, podvodním a podzemním použití, se ukázala tato metoda jako nevyhovující.

\subsubsection{Částečná pozorovatelnost a zpožděné mapování}
Základním typem pozorování je vidění pomocí kamery nebo nějaký typ dálkového senzoru. Kamera, pokud je na robotovi samostatně, zazamenává informace neobsahující přesnou vzdálenost objektu. Tento problém měření pomocí senzoru nemá, neboť meření vzdálenosti bývá velmi přesné, za to se pro tento typ vyskytuje problém se šířkou vysílaného paprsku a postraními žlábky. S tímto senzorem nedokážeme jedním pozorováním ani vytvořit přesně položený landmark, neboť tím získáváme negaussovské rozložení pro pozici landmarku a potřebujeme tak větší počet jeho zpozorování pro vytvoření odhadu.\\
\indent Obecná rozložení umožňují nezpožděné sledování landmarků, zpožděním inicializace však můžeme získat hned gaussovský odhad pozice landmarku, je při tom ale potřeba zaznamenávat pozici robota v každém okamžiku měření, což provedeme rozšířením stavu o vektor pozic. Nejedná se pouze o částečnou pozorovatelnost, ale shromažďování informací a zpoždění rozhodování zvyšuje robustnost procesu. 

\subsubsection{3D SLAM}
Jedná se v podstatě pouze o rozšíření 2D SLAMu, které má však výrazně větší výpočetní složitost a komplikovanější modelování. Rozlišujeme základní tři možnosti. První je klasický 2D SLAM s přidanou schopností vytvářet třetí dimenzi, což se užitečné, pokud se robot pohybuje po rovině. Druhý typ vytváří 3D obraz extrakcí diskrétních landmarků a sdruženého odhadu pozice vozidla a mapy. Využití je vhodné v robotech s jedním senzorem, který umožnuje pohyb se šesti stupni volnosti. Poslední možnost se od těch předchozích dost odlišuje. Sdružený stav se totiž skládá z předchozích pozic robota, na každé pozici se udělá 3D sken prostředí a odhad pozice se vyrovná korelací skenů.
 
\subsubsection{SLAM orientovaný pomocí trajektorie}
Základní formulací problému je odhadovaný stav, jako pozice robota a zaznamenané landmarky, jinou, novější možností, je odhadovat místo toho trajektorii vozidla. Mapa tak není součástí stavu, každá pozice robota má ale přidružený sken svého okolí, které se pak srovnají a vytvoří globální mapu. Z toho je hned patrný problém, neustálý růst stavového prostoru, který se nijak nepromazává. Využití metpdy se nachází například při tvorbě topologických map.

\subsubsection{Vložené pomocné informace}
Ke stavu můžeme připojit roziřující data, v tomto případě například teplotu, charakteristiku povrchu a mnoho dalších věcí, které pak napomáhají při tvorbě mapy. Tvorba takovéto struktury je ale poměrně komplikovaná. Pohybem robota prostředím se ukládají pomocná data do datové struktury tak, že každá buňka v této struktuře je přiřazena danému landmarku v mapě, při aktualizaci jaho pozice se tak přemisťují i přidružené informace. 

\subsubsection{Dynamická prostředí}
Ve světě se setkáváme převážně s dynamicky se vyvíjejícím prostředím, kdy nám do pozorování můžou zasahovat lidé, zvířata nebo třeba nábytek jako židle nebo zaparkovaná auta. Musí se tedy nějak určit, co s takovými objekty bude a jak je za pohyblivé určit. Máme možnost tyto objekty do mapy vůbec nepřidávat, nebo je mít označené za pohyblivé, nesmí se ale stát, že zaznamenáme pohyblivý objekt a uložíme ho jako statický. \\
\indent Klasická implementace SLAM umí odstranit landmark, i poměrně velké množství landmarků, bez většího vlivu na hodnotu konvergence. To je také využíváno pro úpravu mapy, kdy se odstraňují přebytečné landmarky, které se již na svém místě nenacházejí. 

\newpage

\section{Improved techniques for grid mapping with Rao-Blackwellized particle filters}

\subsection{Introduction}
- tvorba mapy - základní funkce mobilního robota (problém mapování = SLAM)\\
- pro odhad pozice dobrá mapa, pro získání mapy dobrý odhad pozice\\
- $\rightarrow$ RBPF - effective solution\\
- redukce dat, převzorkování může elimiovat správné částice $\rightarrow$ problém vyčerpání částice\\
- 2 přístupy zlepšení RBPF \\
- - návrhové rozložení zahrnuje přesnost senzoru $\rightarrow$ přesné vykreslení částic\\
- - vzorkovací technika udžující rozumné množství částic, umožňuje algoritmu určovat přesnou mapu a snižuje riziko vyčerpání částic\\
- návrhové rozložení - vyhodnocováním pravěpodobné pozice (kombinace informací z laseru a odometrie), poslední pozorování použito pro tvorbu nových částic $\rightarrow$ odhad stavu na základě více informací než pouze na odometrii \\
- - přesnější mapa - zvážení vlivu pozorování na pozici, poté až změny v mapě $\rightarrow$ redukce chyby odhadu\\
- - adaptivní vzorkování - udělání zvorku pouze když ho potřebujeme, udržení rozumné různosti částic $\rightarrow$ snížení rizika vyčerpání částice\\

\subsection{Mapping with RBPFs}
- základní úkol - odhad sdružené postreriorní pravděpodobnosti\\
- - cíl - mapa, trajektorie\\
- - odhad na základě - pozorování, odometrie\\
- odhad trajektorie, poté až mapy\\
- mapy tvořeny pozorováním, trajektorie odpovídajícími částicemi (každá částice reprezentuje část trajektorie)\\
- částicové filtry - SIR (sampling importance resampling) filter, pro mapovánní postupně zpracovává data ze sezoru, pak odometrii, updatuje sadu vzorků reprezentujících posterior o mapě a trajektorii\\
- - vzorkování - nové částice jsou získávány z předchozí generace odběrem vzorků z návrhového rozložení (často pravděpodobnostní odometrie) 
- - vážená důležitost - individuální váhu důležitosti má každá částice podle zásady důležitostního vzorkování. Váhu zavádíme kvůli tomu, že cílové rozložení neni rovno tomu navrhovanému.\\
- - převzorkovávání - částice jsou přepisovány úměrně jejich vážené důležitosti, nezbytný krok pro potřebnou konečnost částic k aproximaci kontinuálního rozložení, dále převzorkování umožňuje použít částicový filtr v situaci neschodujícího se cílového rozložení od toho navrhovaného (po převzorkování všechny částice mají stejnou váhu)\\
- - odhad mapy - pro každou částici je vypočítána mapa na základě trajektorie vzorku a historie pozorování\\
- pro implementaci potřeba vyhodnocovat váhy trajektorií při každém pozorování, po delší době neefektivní\\
- omezením navrhovaného rozložení získáme rekurzivní formulaci pro výpočet vážené důležitosti\\

\subsection{RBPF with improved proposals and adaptive resampling}
- zlepšení návrhového rozložení - pro zisk nové generace částic je potřeba vykreslení vzorků z návrhového rozložení (čím lepší návrh tím lepší výsledek, kdyby přímo jako cílové rozložení $\rightarrow$ stejné vážené důležitosti částic, není potřeba převzorkování)\\
- - typický částicový filtr - návrhové rozložení = odometrický pohybový model (+ jednoduchý výpočet pro většinu robotů, vážená důležitost je počítána podle modelu pozorování) - toto rozložení není optimální, zvlášť pokud je senzor výrazně přesnější než odhad pozice (laser)\\ 
- - vyhlazování pravděpodobné funkce - zabránění, částicím v blízkosti významné oblasti, přílišného poklesu vážených důležitostí (- vyřazuje užitečnou informaci ze senzoru $\rightarrow$ nepřesnější mapa)\\
- - překonání problému - zvažovat poslední pozorování při generování nových vzorků, integrováním posledního pozorování do návrhu se dá zaměřit na vzorkování ve významné oblasti pravděpodobnosti pozorování\\
\\
- efektivní výpočet zlepšeného návrhu - nepředvídatelná funkce pravděpodobnosti pozorování $\rightarrow$ nedostupná uzavřená aproximace informačního návrhu\\
- - teorie - získání aproximace upraveným částicovým filtrem - návrh pro každou částici je vypočten odhadem vzorků z optimálního návrhu\\
- - SLAM - navzorkování potenciální pozice z pohybového modelu $\rightarrow$ zvážení vzorků podle pravděpodobnosti pozorování (zisk aproximace optimálního návrhu - pokud již je, stále je potřeba vysoký počet vzorků pozice z pohybového modelu)\\
- - většinou cílové rozložení omezený počet maxim (většinou jedno) $\rightarrow$ vzorkování pozic kolem maxima (snížení složitosti) - zvažujeme pravděpodobnost pozorování i pohybový model v době použití senzoru - lokální aproximace posteriorní pravděpodobnosti kolem maxima pravděpodobnostní funkce\\
- - - na těchto datech počítáme Gaussovskou aproximaci - efektivní vykreslování nových vzorků\\
- - - porovnání scanů pro zisk významé oblasti z funkce pravděpodobnosti pozorování $\rightarrow$ navzorkujeme tuto oblast, vyhodnotíme vzorky podle cílového rozložení\\
- - - pro každou částici $i$ jsou Gaussiánské parametry ($\mu_t^i$, $\Sigma_t^i$) určené individuálně pro daný počet vzorků na intervalu kdy je aktivní senzor + bereme v potaz odometrii při výpočtu střední hodnoty $\mu^i$ a výchylky $\Sigma^i$ $\rightarrow$ zisk uzavřené aproximace optimálního návrhu $\rightarrow$ efektivní zisk nové generace částic - pro výpočet váhové funkce používáme stejný normalizační faktor jako u Gaussiánské aproximace\\
\\
- zlepšený návrh - získání parametrů Gaussiánského návrhu zvlášť pro každou částici (uvažuje odometrii a pozorování, mezitím efektivně vzorkuje), snížená neurčitost výsledných hustot\\
- - porovnávač pozorování určuje režim významné oblasti funkce pravděpodobnosti pozorování - vzorkování z důležitých oblastí - většina porovnávačů maximalizuje pravděpodobnost pozorování, dává mapu a nástřel pozice robota\\
- - vícerežimová pravděpodobnostní funkce (uzavření smyčky) - porovnávač vrátí pro každou částici maximum nejblíže původnímu odhadu - může způsobit ztrátudalších maxim v pravděpodobnostní funkci, protože je hlášen jen 1 režim\\
- - přílišná důvěřivost filtru (teoreticky) - přeplněný prostor + odometrie silně zatížena šumem\\
- - - řešení - sledovat více režimů porovnávače měření + opakovat vzorkování v každém uzlu\\
\\
- adaptivní převzorkování\\
- - převzorkování - důležitý aspekt výkonu částicového filtru, nahrazování vzorků s nízkou váhou důležitosti těmi s vysokou\\
- - - nezbytné - konečný počet částic je použit k aproximaci cílového rozložení (- může odstanit dobré vzorky z filtru $\rightarrow$ ochuzení částic) $\rightarrow$ důležité převzorkování ve správný čas, mít dobré rozhodovacví kritérium\\
- - Liu - efektivní velikost vzorkování pro odhad, jak aktuální sada částic reprezentuje cílový posterior\\
$$N_{eff}=\frac{1}{\varSigma_{i-1}^N(w^{(i)})^2}$$ 
- - - $w^{(i)}$ ... normalizovaná váha částice $i$ \\
- - - $N_{eff}$ - vzorky z cílového rozložení $\rightarrow$ stejné váhové důležitosti (zhoršující se aproximace cílového rozložení $\rightarrow$ větší ochylka váhových důležitostí)\\
- - - - Doucet - převzorkování, když $N_{eff}$ < N/2 (N ... počet částic) - výrazná redukce možnosti nahrazení dobrých částic (redukován počet převzorkování, převzorkování když je potřeba)\\
 - - algoritmus\\
 - - - nástřel pozice reprezentovaný danou částicí, získáno z předchozí pozice této částice a odometrického měření od poslední aktualizace filtru\\
 - - - na základě mapy provedeno porovnání pozorování z místa úvodního nástřelu pozice, vyhledává se pouze v okolí tohoto bodu, v případě selhání - pozice a váhy počítány podle pohybového modelu (další 2 kroky přeskočeny)\\
 - - - vybrána sada vzorků kolem dané pozice, vypočítání průměru a kovarianční matice návrhu bodovým hodnocením cílového rozložení v pozici vzorku, také počítán váhový faktor\\
 - - -  nová pozice částice je zakreslena podle z Gaussovské aproximace podle zlepšeného návrhového rozložení\\
 - - - aktualizace váhových důležitostí\\
 - - - mapa částice je aktualizována podle její zakreslené pozice a pozorování\\
 
\subsection{Implementation issues}
 - porovnávač "vasco" - hledání pozice porovnáním scanu vůči mapě se zanesením i úvodního odhadu (sestupné gradientní hledání v pravděpodobnostní funkci aktuálního pozorování vůči grid mapě - hledání maxima funkce)\\
 - - může být použit každý porovnávač umožňující najít nejlepší zarovnání mezi mapou a aktuálním pozorování s ohledem na úvodní odhad\\
 - Bayesovo pravidlo - hledání pozice\\
 - model koncového bodu - výpočet pravděpodobnosti pozorování\\
 - - paprsky nezávislé - pravděpodobnost paprsku počítána na základě vzdálenosti konce paprsku od nejbližší překážky od tohoto bodu - pro rychlý výpočet využití konvolované lokální grid mapy\\
 - návrh - výpočet 2 komponent - jejich vyhodnocování pro každý vzorek\\
 - - 1. - výpočet podle modelu koncového bodu\\
 - - 2. - Gaussovská aproximace odometrie pohybového modelu - aproximace získána přes rozšíření Taylorovy řady\\
 - 0.5 m mezi 2 použití filtru - aproximace funguje dobře, žádný rozdíl mezi modelem na EKF a přesnějším  modelem rychlosti pohybu na bázi vzorků\\

\subsection{Complexity}
Výpočet návrhového rozložení ... O(N)\\
Aktualizace grid mapy ... O(N)\\
Výpočet vah ... O(N)\\
Testováí potřeby převzorkování ... O(N)\\
Převzorkování ... O(N*M)\\
 - naučení se grid map s RBPF\\
 - - sada vzorků - posteriorní pravděpodobnost o mapách a pozicích\\
 - - počet vrozků - centrální množství\\
 - - návrhové rozložení - vzorkování u nejpravděpodobnější pozice danou porovnávačem pozorování\\
 - - vzorkování pro každou částici, žádná závislost mezi nimi při výpočtu návrhu\\
 - - poslední pozorování - výpočet Gaussiánských parametrů\\
 - - - kryje část mapy $\rightarrow$ komplexita závisí jen na počtu vzorků\\
 - - - - to samé platí pro aktualizaci jednotlivých map spojených s každou částicí\\
 - - kopírování informace náležící částici při převzorkování - nejhůže N-1 částic nahrazeno jednou\\
 - - každá částice si nese svou grid mapu $\rightarrow$ duplikování částice - kopírování její mapy $\rightarrow$ převzorkování má složitost O(N*M) - M ... velikost grid mapy\\
 - - - používání adaptivního převzorkování\\

\subsection{Experiments}
 - ActivMedia Pioneer2 AT, Pioneer 2 DX-8, iRobot B21r\\
 - venkovní i vnitřní prostory\\
 - až rozlišení do 1 cm bez problémů\\
 - 250mx250m - max 80 částic\\
 - výsledky mapování \\
 - - Intel Research Lab - vnitřní prostor, 28mx28m, 15 částic, Pioneer II, SICK senzor, velmi přesné\\
 - - Freiburg Campus - venku, 250mx250m, 30 částic, keře,stromy, pohyblivé předměty (auta, lidi) i tak přesná mapa\\
 - - MIT Killian Court - vnořené smyšky (potenciální vyčerpání částic), dlouhé chodby, důležitá vlastnost adaptivního převzorkování, 60 částic (občas dvojité stěny), 80 částic (vysoká kvalita)\\
 - vyčíslitelné výsledky - porovnání počtu částic s přístupem dirka Hahnela, počet částic které potřebuje RBPF pro vytvoření topologicky přesné mapy alespoň v 60\% použití - Intel (8 vs. 40), Freiburg (20 vs. 400), MIT (60 vs. 400) - mnohem méně částic + lepší mapa (lepší vzorkování) \\
 - účinky lepších návrhů a adaptivního vzorkování\\
 - - zlepšené návrhové rozložení - generování vzorků s vyskovou pravděpodobností, \\
 - - adaptivní vzorkování - $N_{eff}$\\
 - - návrhy bez celé vstupní historie snižují v čase $N_{eff}$ (čím horší návrh, tím rychleji) - obnovení na max hodnotu po převzorkování\\
 - - v této implementaci\\
 - - - zlepšení poklesu $N_{eff}$ - klesá pomaleji i v neznámém prostředí (návrhové rozložeí není tak vypíchnuté)\\
 - - - částice při průchodu známým prostředím zůstávají ve vlastní mapě (díky zlepšenému návrhovému rozložení a kvůli váhám)\\
 - - - uzavírání smyčky - některé částice jsou správně seřazeny (velká váha) a některé chybně (nízká váha) $\rightarrow$ zvětšení výchylek vah $\rightarrow$ snižování $N_{eff}$ - většinou vynucení převzorkování\\
 - - - výrazné snížení pravděpodobnosti vyčerpání částice - uchovávání vzorků v sadě částic\\
 - vliv odometrie na návrh - většinou je návrh jen z laseru dobrý pro odhad pohybu částic, někdy potřeba odometrie pro návrhové rozložení - např. slabé vlastnosti dat z laseru (pustá místa, koridory)\\
 - situace, kdy selhá porovnávač pozorování - nemusí na základě dat dojít k odhadu pozice\\
 - - vzorkujeme rovnou z odometrie pro zisk nových částic\\
 - - vevnitř se tento problém nestává, venku v otevřených prostorách, když laser nikde ve svém rozsahu nic nezaznamenává\\
 - analýza běhu - PC 2.8 GHz procesor, scan při pohybu o 0.5m nebo otočení o $25^o$\\
 - - výpočet návrhového rozložení, vah, aktualizace mapy (1910 ms), testování potřeby převzorkování (41 ms), převzorkování (244 ms)\\


\newpage

\section{Real-Time Loop Closure in 2D LIDAR SLAM \\ CARTOGRAPHER}

\subsection{Úvod}
- veliké mapy, optimalizované výsedky v reálném čase\\
- porovnávání scan-to-scan - rychlé hromadění chyb\\
- porovnávání scan-to-map -  omezení chyb, pokud správný odhad pozice a kvalitní data z LIDAR $\rightarrow$ efektivnost, robustnost\\
- porovnávání přesnosti pixelů - redukce hromadění lokálních chyb oproti scan-to-scan, náročnější, použití při uzavírání smyčky\\
- částicové filtry - tvoří stav systému pro každou částici, pro SLAM s grid-mapami s velkým prostorem rychle roste náročnost - řešení - použití systému děající grid-mapu po čase a ne v každé částici\\
- SLAM na grafu - kolekce nodů reprezentující pozice a funkce, hrany - omezení získaná pozorováním\\

\subsection{System overview}
- real-time 2D mřížková mapa s rozlišením na 5 cm\\
- submapa do odhadované pozice\\
- porovnávání vůči poslední submapě $\rightarrow$ hromadění globálních chyb\\
- neobsahuje částicový filtr - snížení HW požadavků\\
- pořízení submapy, dále již nepřepisování - všechny vzniklé připraveny k porovnávání na uzavření smyčky - blízká odhadovaná pozice + dostatečná shoda $\rightarrow$ přidání omezení uzavření smyčky do optimalizačního problému (odhad pozice) - optimalizace po pár vteřinách - uzavření smyčky je vidět hned \\

\subsection{Local 2D SLAM}
- lokální a globální přístup - obě optimalizace pozice (x, y, natočení)\\
- IMU - inertial measurment unit - odhad směru gravitace, při nerovné ploše\\
- submapa - kousek světa - lokální chyba porovnáváí je odstaněna v globálním přístupu\\
- Sken - iterativní, zarovnávání skenů a souřadnicových snímků submapy\\
- - $H$ ... informace o bodech skenu\\
- - $M$ ... pravděpodobnostní mřížka\\
- - $\xi$ ... pozice snímání skenu\\
- - $T_{\xi}$ ... pozice skenu vůči submapě - transormace - body skenu do submapy\\
- Submapy - pár skenů do submapy - pravděpodobnostní mřížky mapované z diskrétních bodů mřížky v určitém rozlišení (5 cm)\\
- - všechny body mřížky - odpovídající pixel ze všech pixelů nejblíže danému bodu\\
- - přidání skenu do pravděpodobnostní mřížky - výpočet množiny zasažených bodů mřížky a minutých bodů\\
- - zásah - vložíme nejbližší bod mřížky do množiny zásahů\\
- - minutí - vložíme bod mřížky sdružený se všemi pixely, které jsou protínány jedním paprskem mezi počátkem skenování a každým snímacím bodem - nepřidáváme body již přidané do množiny zásahů\\
- - dosud nepozorovaný bod mřížky má přiřazenu pravděpodobnost minutí či zásahu, podle toho jestli je v jedné z těchto množin\\
- - již zpozorovaným bodům aktualizujeme pravděpodobnosti minutí a zásahu\\
- Ceres scan matching - před vložením do submapy - optimalizace pozice skenu vůči submapě - maximalizace pravděpodobnosti\\
$$argmin_\xi\Sigma^K_{k=1}(1-M(T_{\xi}h_k))$$

\subsection{Closing loops}
- hromadění lokálních chyb, jen pár snímků za sebou má vždy minimální chybu vůči sobě\\
- Spare Pose Adjustment - optimalizace pozice snímků\\
- - relativní pozice skenů jsou ukládány, všechny další páry ze skenů a submap jsou brány v potaz při uzavírání smyčky, pokud se submapa nezmění\\
- běh v pozadí, shoda - relativní pozice uložena mezi optimalizační problémy\\
- optimalizační problém - nelineární nejmenší čtevrce, jednoduché přidávání zbytků - zohlednění dalších dat\\
- - 1x za sekundu Ceres - optimalizace pozice skenu v souladu vůči daným omezením - relativní pozice, kovarianční matice\\
$$argmin_{\Xi^m,\Xi^s}0.5\Sigma_{ij}\rho(E^2(\xi_i^m,\xi_j^s,\Sigma_{ij},\xi_{ij}))$$
- - $\rho$ ... ztrátová funkce\\
- - - Huberova ztráta - snížení vlivu odlehlých hodnot - přidávají nesprávná omezení do optimalizačního problému - lokálně symetrická prostředí\\
- branch-and-bound scan matching - větev a mez\\
- - přesnost pixelů\\
$$\xi^*=argmax_{(\xi\epsilon W)}\Sigma_{k=1}^KM_{nearest}(T_{\xi}h_k) $$
- - $W$ ... vyhledávací okno\\
- - $M_{nearest}$ ... rozšíření M na všechny $R^2$ zaokrouhlením argumentů do nejbližšího bodu mřížky - rozšířená hodnota bodu mřížky ukazuje na odpovídající pixel\\
- - vylepšení účinnosti - úhlový krok takový, aby body skenu v maximálním rozsahu nebyly větší než šířka žádného pixelu - pomalé\\
- - použití branch-and-bound - podmnožiny možností jako uzly ve stromu, kořenový uzel jsou všechny možná řešení ($W$)\\
- - uzly - potomci dohromady tvoří stejný soubor možností jako rodičovský uzel\\
- - listy - singlety - jediné proveditelné řešení\\
- - stejné řešení jako předchozí přístup pokud je $score(c)$ vnitřních uzlů horní mezí skóre jeho prvků - neexistuje lepší řešení než to doposud známé\\
- výběr uzlů - prohledávání do hloubky - DFS\\
- - efektivnost závisí na tom jaký je strom - dobrá horní mez a dobré aktuální řešení\\
- - prahová hodnota skóre - pod ní nemáme zájem o dané řešení - nepřidáváme špatné shody jako omezení pro uzavírání smyčky\\
- - - často nepřekonané - snížení výnamu výběru uzlů nebo nalezení počátečního heuristického nastavení\\
- - pořadí průchodu stromu - výpočet horní hranice skóre pro každého potomka, navštívení nejlibnějšího uzlu - největší mezní počet\\
- pravidlo větvení - každý uzel popsán pomocí tuple integerů ($c=(c_x,c_y,c_\Theta,c_h)$ $\epsilon Z^4$)\\
- - $c_h$ ... výška uzlu - $c_h=0 \rightarrow$ uzel je list\\
- výpočet horních mezí - výpočet na vnitřních uzlech - zákem o výpočetní úsilí a kvalitu spojení\\
$$score(c)=\Sigma_{k=1}^Kmax_{(j\epsilon \bar{W})}M_{nearest}(T_{\xi_j}h_k)$$
- - pro výpočet použití předvypočítaného $M_{precomp}^{c_h}$ - můžeme vypočítat skóre s lineární náročností s body skenu\\
- - - udržení nízké naročnosti - čekání než pravděpodobnostní mřížka není již aktualizována, poté výpočet sbírky předvypočítaných mřížek, znovu a začínáme porovnávat\\


\newpage

\section{A Flexible and Scalable SLAM System with Full 3D Motion Estimation \\ Hector SLAM}

\subsection{Úvod}
- nízké výpočetní nároky - malé autonomní systémy\\
- ne pro uzavírání velkých smyček\\
- pro rychlý pohyb terénem\\
- 2D SLAM (soft real time), 3D navigace (hard real time), IMU (inertial measurment unit) - nerovný povrch - narozdíl od gmappingu\\
- frontend SLAM - Hector - odhad pohybu robota v reálném čase\\
- backend SLAM - optimalizace pozičního grafu vzhledem k omezením mezi pozicemi\\

\subsection{System overview}
- pro 6DOF - z 3DOF odhadem nakolonění a rotace - navigační filtr spojí měření z inerciální jednotky a dalších senzorů (3D řešení), informace o poloze (2D SLAM) - volně spojeno, synchronizace v čase\\
- $x=(\Omega^T p^T v^T)^T$ ... reorezentace 3D stavu\\
- $\Omega=(\phi,\theta,\psi)^T$ ... otáčení, stoupání, natočení\\
- $p,v$ ... pozice, rychlost platformy v navigačním rámci\\
- $u=(\omega^T a^T)^T$ ... vstupní vektor pro inerciální měření\\
- $\omega=(\omega_x,\omega_y,\omega_z)^T$ ... úhlová rychlost\\
- $a=(a_x,a_y,a_z)^T$ ... zrychlení\\
pohyb tuhého tělesa
$$\dot{\Omega}=E_\Omega.\omega$$
$$\dot{p}=v$$
$$\dot{v}=R_\Omega.a+g$$
- $R_\Omega$ ... matice směrových cosinů\\
- $E_\Omega$ ... mapování natočení těla na deriváty Eulerova úhlu\\
- $g$ ... vektor gravitace\\
- integrovaná rychlost a pozice - signifikantní šum $\rightarrow$ další informace o senzoru - porovnávání snímků (interiéry), snímač magnetického pole (směr), senzor barometrického tlaku (výška), měření rychlosti kol\\

\subsection{2D SLAM}
- mžížková mapa obsazenosti - reprezentace prostředí, osvědčená lokalizace robota\\
- transformace skenu na lokální stabilizovaný souřadnicový rámec odhadovanou polohou\\
- odhad orientace + sdružené hodnoty $\rightarrow$ bodový oblak bodů - možnost předzpracování - odstranění odlehlých bodů\\
- tady filtrace na základě koncového bodu $z$ - při shodě skenu použity pouze koncové bodyprahové hodnoty skenovací roviny\\
- přístup k mapě - mřížková mapa obsazenosti - omezení přesnosti, neumožnění přímého výpočtu interpolovaných hodnot a derivátů - interpolační schéma - submřížková přesnost buňky bilineárním filtrem\\
- - aproximace souřadnice $P_m$ čtyřmi nejbližšími integerovými souřadnicemi ($P_{00} - P_{11}$)\\
- - vzorkovací body (buňky mřížky) od sebe na vzdálenost 1\\
- porovnávání snímků - zarovnávání snímků vůči sobě nebo celé mapě\\
- - laserové skenery - malý šum, vysoká rychlost dělání snímků $\rightarrow$ možnost velmi přesného měření\\
- - - mnohem větší přesnost než odometrie, pokud vůbec je - v tomto případě nemáme vůbec\\
- - zarovnání koncových bodů s již známou mapou - není zapotřebí hledání spojení mezi koncovými body - porovnání se všemi předchozími skeny\\
- - hledání transformace s nejlepším sladěním skenu s mapou
$$\xi^*=argmin_\xi\Sigma_{i=1}^n[1-M(S_i(\xi))]^2$$
- - $M(P_m)$ ... hodnota obsazenosti\\
- - $S_i(\xi)$ ... souřadnice koncového bodu $s_i=(s_{i,x},s_{i,y})^T$\\
- - $\xi$ ... souřadnice robota\\
- - $M(S_i(\xi))$ ... hodnota mapy v souřadnicích $S_i(\xi)$
- - odhad $\Delta\xi$ - optimalizace chyby měření podle
$$\Sigma_{i=1}^n[1-M(S_i(\xi+\Delta\xi))]^2\rightarrow 0$$
- reprezentace map s více rozlišeními - riziko dosahu pouze lokálního minima - tímto se riziko zmírňuje - více mžížkových map vždy s polovičním rozlišením oproti předchozí - uložených více map, součastné aktualizace odhady pozice generovaných zarovnávacím procesem\\
- - konzistence map napříč stupnicemi, vyhnutí se převzorkování\\
- - zarovnávání skenů na nejvyšší mapě, odhad pozice poté pro všechny ostatní - okamžitá dostupnost hrubých zrnitých map - dobré pro odhad trasy\\
 
\subsection{3D State Estimation}
- odhad úplného 3D stavového vektoru\\
- navigační filtr - 100 Hz - asynchronní aktualizace s pozicí z porovnávače a dalších informací ze senzorů jakmile přijdou\\
- navigační filtr - EKF - odhad 6D pozice - rozšíření ještě o náklon gyroskopů a akcelerometry\\
- - nelineární filtr, inerciální měření se berou jako známé vstupy systému\\
- - aktualizace rychlosti a pozice integrací zrychlení\\
- - aktualizace pseudo-nulové rychlosti - zabránění nezávislému růstu odhadu stavu pokud nejsou k dispozici měření - při dosažení odchylky určité prahové hodnoty - zajištění stability\\
- - pro odhad potřeba barometr, snímač rozsahu\\
- integrace SLAM - 2D SLAM + 3D EKF - komunikace v obou směrech - nesynchronizovány, EKF větší frekvence obnovování\\
- - odhadovaná pozice EKF počáteční odhad pro optimalizaci porovnávání - nebo integrace odhadované rychlosti a úhlové rychlosti\\
- - opačně - kovarianční křižovatka (CI - covariance intersection) - spojení pozice ze SLAM s celkovým odhadovaným stavem\\























\end{document}